<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Vitesse Boss R√©duite de Moiti√©</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
        }
        #game-container {
            border: 2px solid #fff;
            margin: 20px 0;
        }
        .info {
            background: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .controls {
            background: #444;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .controls button {
            background: #666;
            color: #fff;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 3px;
            cursor: pointer;
        }
        .controls button:hover {
            background: #888;
        }
        .metrics {
            background: #2a4a2a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #4f8;
        }
        .speed-comparison {
            display: flex;
            gap: 20px;
            margin: 15px 0;
        }
        .speed-bar {
            flex: 1;
            height: 30px;
            background: #333;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        .speed-fill-old {
            height: 100%;
            background: linear-gradient(90deg, #f84, #fa4);
            border-radius: 15px;
            width: 100%;
            transition: width 0.3s ease;
        }
        .speed-fill-new {
            height: 100%;
            background: linear-gradient(90deg, #4f8, #8f4);
            border-radius: 15px;
            width: 50%;
            transition: width 0.3s ease;
        }
        .speed-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            color: #fff;
            text-shadow: 1px 1px 2px #000;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üêå Test Vitesse Boss - R√âDUITE DE MOITI√â</h1>
    
    <div class="info">
        <h3>‚ö° Vitesse des Boss R√©duite de 50%</h3>
        <p><strong>Toutes les fr√©quences de mouvement ont √©t√© divis√©es par 2 !</strong></p>
        
        <div class="speed-comparison">
            <div>
                <div class="speed-bar">
                    <div class="speed-fill-old"></div>
                    <div class="speed-text">AVANT: 100%</div>
                </div>
                <small>Vitesse originale (trop rapide)</small>
            </div>
            <div>
                <div class="speed-bar">
                    <div class="speed-fill-new"></div>
                    <div class="speed-text">APR√àS: 50%</div>
                </div>
                <small>Vitesse r√©duite de moiti√©</small>
            </div>
        </div>
        
        <ul>
            <li>‚úÖ <strong>Boss 1 (Serpent)</strong> : 0.25 Hz (4 sec/cycle vs 2 sec)</li>
            <li>‚úÖ <strong>Boss 2 (Croiseur)</strong> : Facteur 0.0004 (vs 0.0008)</li>
            <li>‚úÖ <strong>Boss 3 (Station)</strong> : Facteur 0.0003 (vs 0.0006)</li>
            <li>‚úÖ <strong>Boss 4 (Dreadnought)</strong> : Facteur 0.0005 (vs 0.001)</li>
            <li>‚úÖ <strong>Boss 5 (Core Alien)</strong> : Facteur 0.0006 (vs 0.0012)</li>
        </ul>
    </div>
    
    <div class="controls">
        <h3>üéÆ Tests Vitesse R√©duite</h3>
        <button onclick="testBoss(1)">Boss 1 - Serpent (4 sec/cycle)</button>
        <button onclick="testBoss(2)">Boss 2 - Croiseur (tr√®s lent)</button>
        <button onclick="testBoss(3)">Boss 3 - Station (orbital lent)</button>
        <button onclick="testBoss(4)">Boss 4 - Dreadnought (chaos lent)</button>
        <button onclick="testBoss(5)">Boss 5 - Core Alien (chaos lent)</button>
        <button onclick="clearBosses()">Nettoyer</button>
    </div>
    
    <div class="metrics" id="metrics">
        <h3>üìä M√©triques Vitesse R√©duite</h3>
        <div id="speed-comparison">
            <div><strong>Boss 1 - Fr√©quence AVANT:</strong> 0.5 Hz (2 secondes/cycle)</div>
            <div><strong>Boss 1 - Fr√©quence APR√àS:</strong> 0.25 Hz (4 secondes/cycle)</div>
            <div><strong>R√âDUCTION:</strong> 50% plus lent</div>
        </div>
        <hr>
        <div id="position-info">Position: En attente...</div>
        <div id="movement-info">Mouvement: En attente...</div>
        <div id="frequency-info">Fr√©quence: En attente...</div>
        <div id="cycle-info">Temps de cycle: En attente...</div>
    </div>
    
    <div id="game-container"></div>

    <!-- Phaser.js -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
    
    <!-- Game files -->
    <script src="js/config.js"></script>
    <script src="js/managers/ScoreManager.js"></script>
    <script src="js/managers/LevelManager.js"></script>
    <script src="js/entities/Player.js"></script>
    <script src="js/entities/Enemy.js"></script>
    <script src="js/entities/Bullet.js"></script>
    <script src="js/entities/Boss.js"></script>
    <script src="js/scenes/PreloadScene.js"></script>
    
    <script>
        let game;
        let gameScene;
        let currentBoss;
        let debugZone;
        let metricsInterval;
        let cycleStartTime = 0;
        let lastPosition = 0;
        
        // Configuration Phaser pour test vitesse r√©duite
        const testConfig = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            parent: 'game-container',
            backgroundColor: '#001122',
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 0 },
                    debug: false
                }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };
        
        function preload() {
            console.log('üîß Loading assets for reduced speed test...');
            
            // Cr√©er les textures des boss
            createBossTextures.call(this);
            
            console.log('‚úÖ Boss textures created for speed test');
        }
        
        function createBossTextures() {
            // Boss 1 - Serpent
            const graphics1 = this.add.graphics();
            graphics1.fillStyle(0x666666);
            graphics1.fillRect(0, 40, 240, 40);
            graphics1.fillStyle(0x888888);
            graphics1.fillRect(20, 35, 200, 10);
            graphics1.fillRect(20, 75, 200, 10);
            graphics1.fillStyle(0xff0000);
            graphics1.fillCircle(220, 50, 4);
            graphics1.fillCircle(220, 70, 4);
            graphics1.fillStyle(0x999999);
            for (let i = 0; i < 5; i++) {
                graphics1.fillCircle(40 + i * 40, 60, 8);
            }
            graphics1.generateTexture('boss1', 240, 120);
            graphics1.destroy();
            
            // Boss 2-5 (versions simplifi√©es)
            const graphics2 = this.add.graphics();
            graphics2.fillStyle(0x555555);
            graphics2.fillRect(0, 50, 220, 40);
            graphics2.generateTexture('boss2', 220, 140);
            graphics2.destroy();
            
            const graphics3 = this.add.graphics();
            graphics3.fillStyle(0x4a4a6a);
            graphics3.fillRect(60, 60, 80, 40);
            graphics3.fillStyle(0x8a4fff);
            graphics3.fillCircle(100, 80, 15);
            graphics3.generateTexture('boss3', 200, 160);
            graphics3.destroy();
            
            const graphics4 = this.add.graphics();
            graphics4.fillStyle(0x2a2a2a);
            graphics4.fillRect(0, 40, 260, 40);
            graphics4.fillStyle(0xff0000);
            graphics4.fillCircle(240, 50, 3);
            graphics4.fillCircle(240, 70, 3);
            graphics4.generateTexture('boss4', 260, 120);
            graphics4.destroy();
            
            const graphics5 = this.add.graphics();
            graphics5.fillStyle(0x4a0e4e);
            graphics5.fillCircle(100, 100, 50);
            graphics5.fillStyle(0x9c27b0);
            graphics5.fillCircle(100, 100, 30);
            graphics5.fillStyle(0xff1744);
            graphics5.fillCircle(90, 90, 8);
            graphics5.fillCircle(110, 90, 8);
            graphics5.generateTexture('boss5', 200, 200);
            graphics5.destroy();
            
            // Missile ennemi
            const bulletGraphics = this.add.graphics();
            bulletGraphics.fillStyle(0xff4444);
            bulletGraphics.fillRect(0, 0, 20, 8);
            bulletGraphics.generateTexture('enemy-missile', 20, 8);
            bulletGraphics.destroy();
        }
        
        function create() {
            gameScene = this;
            
            // Cr√©er les guides visuels
            createSpeedGuides.call(this);
            
            // Initialiser le level manager
            this.levelManager = { currentLevel: 1 };
            
            // Cr√©er le groupe de balles ennemies
            this.enemyBullets = this.physics.add.group();
            
            // Texte d'information
            this.add.text(10, 10, 'Test Vitesse Boss - R√âDUITE DE MOITI√â', {
                fontSize: '16px',
                fill: '#00ff00'
            });
            
            this.add.text(10, 30, 'Boss 1: 4 sec/cycle (vs 2 sec) | Toutes fr√©quences divis√©es par 2', {
                fontSize: '11px',
                fill: '#00ff00'
            });
            
            this.add.text(10, 50, 'Mouvement plus lent et plus contr√¥lable', {
                fontSize: '12px',
                fill: '#ffff00'
            });
            
            // D√©marrer les m√©triques
            startMetrics();
            
            console.log('‚úÖ Reduced speed system ready for testing');
        }
        
        function update() {
            if (currentBoss && currentBoss.update) {
                currentBoss.update();
            }
        }
        
        function createSpeedGuides() {
            const graphics = this.add.graphics();
            
            // Zone de mouvement (30% droits)
            const zoneLeft = GameConfig.width * 0.7;
            const zoneRight = GameConfig.width - 20;
            const zoneTop = 20;
            const zoneBottom = GameConfig.height - 20;
            
            // Zone de mouvement principale (verte)
            graphics.lineStyle(2, 0x00ff00, 0.7);
            graphics.strokeRect(zoneLeft, zoneTop, zoneRight - zoneLeft, zoneBottom - zoneTop);
            
            // Centre de la zone
            const centerY = (zoneTop + zoneBottom) / 2;
            const centerX = (zoneLeft + zoneRight) / 2;
            graphics.lineStyle(1, 0xffff00, 0.5);
            graphics.moveTo(zoneLeft, centerY);
            graphics.lineTo(zoneRight, centerY);
            graphics.strokePath();
            
            // Limites d'amplitude pour Boss 1 (90%)
            const amplitude90 = (zoneBottom - zoneTop) * 0.45;
            graphics.lineStyle(1, 0x00ffff, 0.6);
            graphics.moveTo(zoneLeft, centerY - amplitude90);
            graphics.lineTo(zoneRight, centerY - amplitude90);
            graphics.strokePath();
            graphics.moveTo(zoneLeft, centerY + amplitude90);
            graphics.lineTo(zoneRight, centerY + amplitude90);
            graphics.strokePath();
            
            // Labels
            this.add.text(zoneLeft - 120, centerY - amplitude90 - 10, 'Limite 90% (4 sec/cycle)', {
                fontSize: '9px',
                fill: '#00ffff'
            });
            
            this.add.text(zoneLeft - 80, centerY - 5, 'Centre', {
                fontSize: '10px',
                fill: '#ffff00'
            });
            
            debugZone = graphics;
        }
        
        function testBoss(level) {
            clearBosses();
            
            // Mettre √† jour le level manager
            gameScene.levelManager.currentLevel = level;
            
            // Donn√©es des boss
            const bossData = {
                health: 50,
                pattern: ['serpent', 'cruiser', 'station', 'dreadnought', 'final'][level - 1],
                name: ['Serpent M√©canique', 'Croiseur Lourd', 'Station Orbitale', 'Dreadnought', 'Core Alien'][level - 1]
            };
            
            // Cr√©er le boss
            currentBoss = new Boss(gameScene, GameConfig.width + 100, GameConfig.height / 2, bossData);
            
            // R√©initialiser les m√©triques de cycle
            cycleStartTime = Date.now();
            lastPosition = currentBoss.y;
            
            console.log(`üêå Boss ${level} spawned with REDUCED SPEED (50%):`);
            console.log(`- Pattern: ${bossData.pattern}`);
            console.log(`- Speed: 50% of original`);
            
            const frequencies = {
                1: '0.25 Hz (4 sec/cycle vs 2 sec)',
                2: 'Factor 0.0004 (vs 0.0008)',
                3: 'Factor 0.0003 (vs 0.0006)',
                4: 'Factor 0.0005 (vs 0.001)',
                5: 'Factor 0.0006 (vs 0.0012)'
            };
            
            console.log(`- Frequency: ${frequencies[level]}`);
            
            updateStatus(`Boss ${level} (${bossData.name}) spawn√© avec vitesse r√©duite 50%`);
        }
        
        function clearBosses() {
            if (currentBoss) {
                currentBoss.destroy();
                currentBoss = null;
            }
            updateStatus('Boss nettoy√©');
        }
        
        function startMetrics() {
            metricsInterval = setInterval(() => {
                if (currentBoss) {
                    const currentTime = Date.now();
                    const elapsedSeconds = (currentTime - cycleStartTime) / 1000;
                    
                    document.getElementById('position-info').textContent = 
                        `Position: X=${Math.round(currentBoss.x)}, Y=${Math.round(currentBoss.y)}`;
                    
                    document.getElementById('movement-info').textContent = 
                        `Mouvement: ${currentBoss.pattern} (vitesse r√©duite 50%)`;
                    
                    if (currentBoss.pattern === 'serpent') {
                        document.getElementById('frequency-info').textContent = 
                            `Fr√©quence: 0.25 Hz (vs 0.5 Hz original)`;
                        
                        document.getElementById('cycle-info').textContent = 
                            `Temps de cycle: 4 secondes (vs 2 sec) | √âcoul√©: ${elapsedSeconds.toFixed(1)}s`;
                    } else {
                        document.getElementById('frequency-info').textContent = 
                            `Fr√©quence: R√©duite de 50% selon le pattern`;
                        
                        document.getElementById('cycle-info').textContent = 
                            `Temps √©coul√©: ${elapsedSeconds.toFixed(1)}s`;
                    }
                }
            }, 100);
        }
        
        function updateStatus(message) {
            console.log(`üìä ${message}`);
        }
        
        // Initialiser le jeu
        game = new Phaser.Game(testConfig);
        
        // Auto-test du Boss 1 apr√®s 3 secondes
        setTimeout(() => {
            testBoss(1);
        }, 3000);
    </script>
</body>
</html>
